---
title: "Demographics"
output: html_document
date: '2022-04-28'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
data8 <- read_tsv("data/02_large_w_meta_clean.tsv")
    
data8 %>% 
  ggplot(aes(age, fill=disease)) +
    geom_histogram(colour="#000000") -> histogram

data8 %>% 
  drop_na(age) %>% 
  filter(disease=="Normal") %>% 
  select(age) %>% 
  mean("age") 

means <- data8 %>% 
  drop_na(age) %>% 
  group_by(disease) %>% 
  summarize(Mean = round(mean(age, na.rm=TRUE))) %>% 
  as_tibble()

female <- data8 %>% 
  filter(sex=="F") %>% 
  group_by(disease) %>% 
  summarise(n())

male <- data8 %>% 
  filter(sex=="M") %>% 
  group_by(disease) %>% 
  summarise(n())

density <- data8 %>% 
  drop_na(age) %>% 
  ggplot(aes(age, fill=disease)) +
  geom_density(alpha=0.4) 

histogram <- data8 %>% 
  drop_na(sex) %>% 
  ggplot(aes(disease, fill=sex)) +
  geom_bar(alpha=0.4)

histogram +
  facet_wrap(vars(sex)) +
  theme(strip.text.y = element_text(angle = 45), 
        axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

density + 
   geom_vline(data = means, aes(xintercept=Mean), size=0.5, color="red") +
   geom_label(data=means, size=2.5, 
             aes(x=Mean, y=5, label=paste0(Mean))) +
   facet_wrap(vars(disease), ncol=1) #treatment cohort
```

